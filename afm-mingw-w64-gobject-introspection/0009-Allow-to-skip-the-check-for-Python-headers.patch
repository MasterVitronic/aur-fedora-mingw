From 5e60a0e11e2daedf12c80027b5330fb3efa18037 Mon Sep 17 00:00:00 2001
From: Nicola Fontana <ntd@entidi.it>
Date: Tue, 24 Mar 2015 19:23:38 +0100
Subject: [PATCH 09/11] Allow to skip the check for Python headers

When building without _giscanner.la (e.g., during the second step of a
MinGW cross compilation) there is no need to build the Python module,
hence there is no need to check for its headers (that in turn would
require the installation of the whole python2 toolchain on the host).
---
 configure.ac | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

diff --git a/configure.ac b/configure.ac
index aeea00d..66050fe 100644
--- a/configure.ac
+++ b/configure.ac
@@ -272,10 +272,13 @@ case "$host" in
 	pyexecdir=`echo $pyexecdir | tr '\\\\' '/'`
 	;;
 esac
-AM_CHECK_PYTHON_HEADERS(, AC_MSG_ERROR([Python headers not found]))
-if test "x$os_win32" = "xyes"; then
-  AM_CHECK_PYTHON_LIBS(, AC_MSG_ERROR([Python libs not found. Windows requires Python modules to be explicitly linked to libpython.]))
-fi
+AC_ARG_ENABLE(giscanner,AS_HELP_STRING([--disable-giscanner],[disable giscanner python module]),,enable_giscanner=yes)
+AS_IF([test x$enable_giscanner != xno], [
+  AM_CHECK_PYTHON_HEADERS(, AC_MSG_ERROR([Python headers not found]))
+  if test "x$os_win32" = "xyes"; then
+    AM_CHECK_PYTHON_LIBS(, AC_MSG_ERROR([Python libs not found. Windows requires Python modules to be explicitly linked to libpython.]))
+  fi
+])
 AC_MSG_CHECKING(for the Python path separator)
 PYTHONPATHSEP=$($PYTHON -c 'import sys, os; sys.stdout.write(os.pathsep)')
 AC_SUBST(PYTHONPATHSEP)
-- 
2.7.0

